<Page x:Class="PhotoBooth.Pages.StartPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:fa="http://metro.mahapps.com/winfx/xaml/iconpacks"
      Title="Start Page"
      HorizontalAlignment="Stretch"
      VerticalAlignment="Stretch">
    
    <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
        <!-- Background matching StyleSelectionPage -->
        <Grid.Background>
            <SolidColorBrush Color="#221017"/>
        </Grid.Background>

        <!-- Ambient Background Glows -->
        <Canvas ClipToBounds="False">
            <!-- Top Left Glow -->
            <Ellipse Width="1000" Height="1000" 
                     Canvas.Left="-300" Canvas.Top="-200"
                     Opacity="0.2">
                <Ellipse.Fill>
                    <RadialGradientBrush>
                        <GradientStop Color="#f4257b" Offset="0"/>
                        <GradientStop Color="Transparent" Offset="1"/>
                    </RadialGradientBrush>
                </Ellipse.Fill>
                <Ellipse.Effect>
                    <BlurEffect Radius="120"/>
                </Ellipse.Effect>
            </Ellipse>

            <!-- Bottom Right Glow -->
            <Ellipse Width="1200" Height="1200"
                     Canvas.Right="-400" Canvas.Bottom="-400"
                     Opacity="0.1">
                <Ellipse.Fill>
                    <RadialGradientBrush>
                        <GradientStop Color="#a855f7" Offset="0"/>
                        <GradientStop Color="Transparent" Offset="1"/>
                    </RadialGradientBrush>
                </Ellipse.Fill>
                <Ellipse.Effect>
                    <BlurEffect Radius="150"/>
                </Ellipse.Effect>
            </Ellipse>
        </Canvas>

        <!-- Main Content Layout -->
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header: Event Name Chip -->
            <Border Grid.Row="0"
                    Name="EventChip"
                    HorizontalAlignment="Center"
                    Margin="0,40,0,0"
                    Padding="18,10"
                    CornerRadius="24"
                    Background="#1A161024"
                    BorderBrush="#33FFFFFF"
                    BorderThickness="1"
                    Opacity="0">
                <StackPanel Orientation="Horizontal">
                    <fa:PackIconFontAwesome Kind="GiftSolid"
                                            Width="18" Height="18"
                                            Foreground="#f4257b"
                                            Margin="0,0,8,0"
                                            VerticalAlignment="Center"/>
                    <TextBlock Text="Sarah's 21st Birthday"
                              FontSize="14"
                              FontWeight="Bold"
                              Foreground="White"
                              VerticalAlignment="Center"/>
                              <fa:PackIconFontAwesome Kind="StarSolid"
                                            Width="18" Height="18"
                                            Foreground="#FFD700"
                                            Margin="0,0,8,0"
                                            VerticalAlignment="Center"/>
                </StackPanel>
            </Border>

            <!-- Main Content -->
            <StackPanel Grid.Row="1"
                       Name="HeroSection"
                       VerticalAlignment="Center"
                       HorizontalAlignment="Center"
                       Opacity="0"
                       Margin="0,10,0,0">
                
                <!-- Mascot -->
                <Grid Width="260" Height="260" Margin="0,0,0,40">
                    <Ellipse Width="260" Height="260" Opacity="0.35">
                        <Ellipse.Fill>
                            <RadialGradientBrush>
                                <GradientStop Color="#f4257b" Offset="0"/>
                                <GradientStop Color="Transparent" Offset="1"/>
                            </RadialGradientBrush>
                        </Ellipse.Fill>
                    </Ellipse>
                    <Border Width="240" Height="240"
                            CornerRadius="120"
                            BorderBrush="#26FFFFFF"
                            BorderThickness="3"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center">
                        <Border.Effect>
                            <DropShadowEffect Color="#000000" BlurRadius="22" ShadowDepth="0" Opacity="0.45"/>
                        </Border.Effect>
                        <Border.Background>
                            <ImageBrush ImageSource="/Assets/logo.png" Stretch="UniformToFill"/>
                        </Border.Background>
                    </Border>
                </Grid>

                <!-- Heading & CTA -->
                <StackPanel>
                    <TextBlock Text="Ready to Pose?"
                              FontSize="80"
                              FontWeight="Black"
                              Foreground="White"
                              HorizontalAlignment="Center"
                              TextAlignment="Center"
                              Margin="0,0,0,12"/>

                    <TextBlock Text="Touch the button below to start capturing memories!"
                              FontSize="18"
                              FontWeight="Medium"
                              Foreground="#D8D0DC"
                              HorizontalAlignment="Center"
                              TextAlignment="Center"
                              Margin="0,0,0,32"/>

                    <Button Name="StartButton"
                            Width="300"
                            Height="78"
                            Cursor="Hand"
                            Click="StartButton_Click"
                            HorizontalAlignment="Center">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="ButtonBorder"
                                        Background="#f62585"
                                        CornerRadius="40"
                                        BorderThickness="0">
                                    <Border.Effect>
                                        <DropShadowEffect x:Name="ButtonShadow"
                                                        Color="#f62585" 
                                                        BlurRadius="28" 
                                                        ShadowDepth="0" 
                                                        Opacity="0.6"/>
                                    </Border.Effect>
                                    <Grid ClipToBounds="True">
                                        <!-- Shimmer -->
                                        <Border CornerRadius="40" ClipToBounds="True" Width="300" Height="78">
                                            <Rectangle x:Name="ShimmerRect" 
                                                      Width="120" 
                                                      Height="78" 
                                                      RadiusX="40"
                                                      RadiusY="40"
                                                      HorizontalAlignment="Left"
                                                      Margin="-120,0,0,0"
                                                      Opacity="0.3">
                                                <Rectangle.Fill>
                                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                        <GradientStop Color="Transparent" Offset="0"/>
                                                        <GradientStop Color="White" Offset="0.5"/>
                                                        <GradientStop Color="Transparent" Offset="1"/>
                                                    </LinearGradientBrush>
                                                </Rectangle.Fill>
                                                <Rectangle.RenderTransform>
                                                    <TranslateTransform x:Name="ShimmerTransform"/>
                                                </Rectangle.RenderTransform>
                                            </Rectangle>
                                        </Border>

                        <StackPanel Orientation="Horizontal"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"
                                   Margin="0,2,0,0">
                            <TextBlock Text="Let's Go" 
                                      FontSize="24" 
                                      FontWeight="Black" 
                                      Foreground="White"
                                      VerticalAlignment="Center"
                                      Margin="0,0,10,0"/>
                            <fa:PackIconFontAwesome Kind="CameraSolid"
                                                    Width="22" Height="22"
                                                    Foreground="White"
                                                    VerticalAlignment="Center"/>
                        </StackPanel>
                                    </Grid>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Trigger.EnterActions>
                                            <BeginStoryboard>
                                                <Storyboard>
                                                    <DoubleAnimation Storyboard.TargetName="ShimmerTransform"
                                                                   Storyboard.TargetProperty="X"
                                                                   From="-120" To="300" Duration="0:0:0.8"/>
                                                </Storyboard>
                                            </BeginStoryboard>
                                        </Trigger.EnterActions>
                                        <Trigger.ExitActions>
                                            <BeginStoryboard>
                                                <Storyboard>
                                                    <DoubleAnimation Storyboard.TargetName="ShimmerTransform"
                                                                   Storyboard.TargetProperty="X"
                                                                   To="-120" Duration="0:0:0.2"/>
                                                </Storyboard>
                                            </BeginStoryboard>
                                        </Trigger.ExitActions>
                                    </Trigger>
                                    <Trigger Property="IsPressed" Value="True">
                                        <Setter TargetName="ButtonBorder" Property="RenderTransform">
                                            <Setter.Value>
                                                <ScaleTransform ScaleX="0.96" ScaleY="0.96" CenterX="150" CenterY="39"/>
                                            </Setter.Value>
                                        </Setter>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="RenderTransformOrigin" Value="0.5,0.5"/>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="RenderTransform">
                                            <Setter.Value>
                                                <ScaleTransform ScaleX="1.03" ScaleY="1.03"/>
                                            </Setter.Value>
                                        </Setter>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                </StackPanel>
            </StackPanel>

            <!-- Footer -->
            <Grid Grid.Row="2" Margin="0,0,0,32">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="1"
                          Text="Powered by Magnificenz Tech Solutions"
                          FontSize="13"
                          FontWeight="Medium"
                          Foreground="#c7a8c5"
                          Opacity="0.9"
                          HorizontalAlignment="Center"
                          VerticalAlignment="Center"/>

                <!-- Settings -->
                <Border Grid.Column="2"
                        Name="SettingsBorder"
                        Width="46"
                        Height="46"
                        CornerRadius="23"
                        Background="#18000000"
                        BorderBrush="#26FFFFFF"
                        BorderThickness="1"
                        HorizontalAlignment="Right"
                        Margin="0,0,30,0"
                        Cursor="Hand"
                        MouseLeftButtonUp="SettingsBorder_MouseLeftButtonUp">
                    <Grid>
                        <!-- Settings Icon (visible when not syncing) -->
                        <fa:PackIconFontAwesome Name="SettingsIcon"
                                                Kind="GearSolid"
                                                Width="20" Height="20"
                                                Foreground="#FFFFFF"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                Visibility="Visible"/>
                        
                        <!-- Loading Spinner (visible when syncing) -->
                        <Border Name="SyncLoaderBorder"
                                Visibility="Collapsed"
                                Width="20" Height="20"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Top"
                                Margin="0,2,0,0">
                            <Border.RenderTransform>
                                <RotateTransform x:Name="SyncLoaderRotate" CenterX="10" CenterY="10"/>
                            </Border.RenderTransform>
                            <fa:PackIconFontAwesome Kind="GearSolid"
                                                    Width="20" Height="20"
                                                    Foreground="#f4257b"
                                                    HorizontalAlignment="Center"
                                                    VerticalAlignment="Center"/>
                        </Border>
                        
                        <!-- Progress Text (visible when syncing) -->
                        <TextBlock Name="SyncProgressText"
                                   Text=""
                                   FontSize="5.5"
                                   Foreground="#f4257b"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Bottom"
                                   Margin="0,0,0,2"
                                   Visibility="Collapsed"
                                   TextAlignment="Center"
                                   FontWeight="Bold"
                                   RenderTransformOrigin="0.5,0.5">
                            <TextBlock.Effect>
                                <DropShadowEffect Color="#000000" BlurRadius="2" ShadowDepth="0" Opacity="0.8"/>
                            </TextBlock.Effect>
                        </TextBlock>
                    </Grid>
                    <Border.RenderTransform>
                        <RotateTransform x:Name="SettingsRotate" CenterX="23" CenterY="23"/>
                    </Border.RenderTransform>
                    <Border.InputBindings>
                        <MouseBinding Gesture="LeftClick" Command="{x:Null}"/>
                    </Border.InputBindings>
                    <Border.Triggers>
                        <EventTrigger RoutedEvent="MouseEnter">
                            <BeginStoryboard>
                                <Storyboard>
                                    <DoubleAnimation Storyboard.TargetName="SettingsRotate"
                                                   Storyboard.TargetProperty="Angle"
                                                   To="90" Duration="0:0:0.4"/>
                                </Storyboard>
                            </BeginStoryboard>
                        </EventTrigger>
                        <EventTrigger RoutedEvent="MouseLeave">
                            <BeginStoryboard>
                                <Storyboard>
                                    <DoubleAnimation Storyboard.TargetName="SettingsRotate"
                                                   Storyboard.TargetProperty="Angle"
                                                   To="0" Duration="0:0:0.4"/>
                                </Storyboard>
                            </BeginStoryboard>
                        </EventTrigger>
                    </Border.Triggers>
                </Border>
            </Grid>
        </Grid>

        <!-- Loading Overlay (Preserved from original) -->
        <Border Name="LoadingPanel"
                Background="#F0000000"
                Visibility="Collapsed">
            <Border Width="500"
                    Height="300"
                    Background="#152d1520"
                    CornerRadius="30"
                    BorderBrush="#f4257b"
                    BorderThickness="3"
                    Padding="40">
                <Border.Effect>
                    <DropShadowEffect Color="#f4257b" BlurRadius="60" ShadowDepth="0" Opacity="0.7"/>
                </Border.Effect>
                
                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock Text="Loading Configuration..."
                              FontSize="32"
                              FontWeight="Bold"
                              Foreground="White"
                              HorizontalAlignment="Center"
                              Margin="0,0,0,30">
                        <TextBlock.Effect>
                            <DropShadowEffect Color="#f4257b" BlurRadius="20" ShadowDepth="0" Opacity="0.9"/>
                        </TextBlock.Effect>
                    </TextBlock>
                    
                    <Grid Width="400" Height="30">
                        <Border Background="#30FFFFFF" 
                                CornerRadius="4" 
                                Height="8" 
                                VerticalAlignment="Center"/>
                        
                        <Rectangle x:Name="LoadingBox"
                                  Width="60"
                                  Height="20"
                                  RadiusX="4"
                                  RadiusY="4"
                                  Fill="#f4257b"
                                  HorizontalAlignment="Left">
                            <Rectangle.Effect>
                                <DropShadowEffect Color="#f4257b" BlurRadius="20" ShadowDepth="0" Opacity="0.9"/>
                            </Rectangle.Effect>
                            <Rectangle.RenderTransform>
                                <TranslateTransform x:Name="LoadingBoxTransform"/>
                            </Rectangle.RenderTransform>
                            <Rectangle.Triggers>
                                <EventTrigger RoutedEvent="Loaded">
                                    <BeginStoryboard>
                                        <Storyboard RepeatBehavior="Forever">
                                            <DoubleAnimation Storyboard.TargetName="LoadingBoxTransform"
                                                           Storyboard.TargetProperty="X"
                                                           From="0" To="340" Duration="0:0:1.2"
                                                           AutoReverse="True">
                                                <DoubleAnimation.EasingFunction>
                                                    <CubicEase EasingMode="EaseInOut"/>
                                                </DoubleAnimation.EasingFunction>
                                            </DoubleAnimation>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </EventTrigger>
                            </Rectangle.Triggers>
                        </Rectangle>
                    </Grid>
                    
                    <TextBlock Text="Please wait..."
                              FontSize="18"
                              Foreground="#C0FFFFFF"
                              HorizontalAlignment="Center"
                              Margin="0,20,0,0"/>
                </StackPanel>
            </Border>
        </Border>

        <!-- Error Overlay (Preserved from original) -->
        <Border Name="ErrorBorder"
                Background="#F0000000"
                Visibility="Collapsed">
            <Border Width="600"
                    MaxHeight="450"
                    Background="#252d1520"
                    CornerRadius="30"
                    BorderBrush="#E94560"
                    BorderThickness="3"
                    Padding="50">
                <Border.Effect>
                    <DropShadowEffect Color="#FF0000" BlurRadius="60" ShadowDepth="0" Opacity="0.7"/>
                </Border.Effect>

                <StackPanel>
                    <Border Width="100" Height="100"
                            Background="#E94560"
                            CornerRadius="50"
                            HorizontalAlignment="Center"
                            Margin="0,0,0,30">
                        <TextBlock Text="⚠️" FontSize="60" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Border>

                    <TextBlock Text="Connection Error"
                              FontSize="40"
                              FontWeight="Black"
                              Foreground="White"
                              HorizontalAlignment="Center"
                              Margin="0,0,0,20"/>
                    
                    <TextBlock Name="ErrorText"
                              Text="Unable to connect to the server"
                              FontSize="20"
                              Foreground="#FFD0D8"
                              TextWrapping="Wrap"
                              TextAlignment="Center"
                              Margin="0,0,0,30"/>

                    <Button Content="RETRY"
                            FontSize="28"
                            FontWeight="Bold"
                            Width="200"
                            Height="60"
                            Foreground="White"
                            Background="#E94560"
                            BorderThickness="0"
                            Cursor="Hand"
                            Click="StartButton_Click">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}"
                                        CornerRadius="30">
                                    <Border.Effect>
                                        <DropShadowEffect Color="#FF0000" BlurRadius="25" ShadowDepth="0" Opacity="0.5"/>
                                    </Border.Effect>
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </ControlTemplate>
                        </Button.Template>
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="RenderTransformOrigin" Value="0.5,0.5"/>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="RenderTransform">
                                            <Setter.Value>
                                                <ScaleTransform ScaleX="1.05" ScaleY="1.05"/>
                                            </Setter.Value>
                                        </Setter>
                                    </Trigger>
                                    <Trigger Property="IsPressed" Value="True">
                                        <Setter Property="RenderTransform">
                                            <Setter.Value>
                                                <ScaleTransform ScaleX="0.97" ScaleY="0.97"/>
                                            </Setter.Value>
                                        </Setter>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                </StackPanel>
            </Border>
        </Border>
        
        <!-- Settings Popup -->
        <Popup Name="SettingsPopup"
               Placement="Custom"
               PlacementTarget="{Binding ElementName=SettingsBorder}"
               StaysOpen="False"
               AllowsTransparency="True"
               PopupAnimation="Fade">
            <Border Background="#E6221017"
                    CornerRadius="8"
                    BorderBrush="#4DFFFFFF"
                    BorderThickness="1"
                    Padding="6,4"
                    MaxWidth="220">
                <Border.Effect>
                    <DropShadowEffect Color="#000000" BlurRadius="20" ShadowDepth="0" Opacity="0.7"/>
                </Border.Effect>
                <Border.Resources>
                    <Style x:Key="SettingsMenuButtonStyle" TargetType="Button">
                        <Setter Property="Background" Value="Transparent"/>
                        <Setter Property="Foreground" Value="#D8D0DC"/>
                        <Setter Property="FontSize" Value="12"/>
                        <Setter Property="FontWeight" Value="Medium"/>
                        <Setter Property="Padding" Value="12,8"/>
                        <Setter Property="Margin" Value="0,2,0,0"/>
                        <Setter Property="BorderThickness" Value="0"/>
                        <Setter Property="Cursor" Value="Hand"/>
                        <Setter Property="HorizontalAlignment" Value="Stretch"/>
                        <Setter Property="HorizontalContentAlignment" Value="Left"/>
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="{TemplateBinding Background}"
                                            CornerRadius="4"
                                            Padding="{TemplateBinding Padding}">
                                        <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" 
                                                        VerticalAlignment="Center"/>
                                    </Border>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                        <Style.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#33000000"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </Border.Resources>
                
                <StackPanel>
                    <Button Name="SyncConfigButton" 
                            Content="Config &amp; Frame Sync" 
                            Click="SyncConfigButton_Click"
                            Style="{StaticResource SettingsMenuButtonStyle}"/>
                    
                    <Button Name="SyncOfflineDataButton" 
                            Content="Sync Offline Data" 
                            Click="SyncOfflineDataButton_Click"
                            Style="{StaticResource SettingsMenuButtonStyle}"/>
                    
                    <Button Name="UploadOfflineFramesButton" 
                            Content="Upload Offline Frames" 
                            Click="UploadOfflineFramesButton_Click"
                            Style="{StaticResource SettingsMenuButtonStyle}"/>
                    
                    <Button Name="UpdateCodesButton" 
                            Content="Update Machine &amp; Site Code" 
                            Click="UpdateCodesButton_Click"
                            Style="{StaticResource SettingsMenuButtonStyle}"/>
                </StackPanel>
            </Border>
        </Popup>
    </Grid>
</Page>
