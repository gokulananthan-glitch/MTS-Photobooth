<Page x:Class="PhotoBooth.Pages.FrameSelectionPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:fa="http://metro.mahapps.com/winfx/xaml/iconpacks"
      Title="Select Your Frame">
    
    <Page.Resources>
        <!-- Boolean to Visibility Converter -->
        <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
    </Page.Resources>
    
    <Grid>
        <!-- Background -->
        <Grid.Background>
            <SolidColorBrush Color="#221017"/>
        </Grid.Background>
        
        <!-- Ambient Background Glows -->
        <Canvas ClipToBounds="False">
            <!-- Top Left Glow -->
            <Ellipse Width="1000" Height="1000" 
                     Canvas.Left="-300" Canvas.Top="-200"
                     Opacity="0.2">
                <Ellipse.Fill>
                    <RadialGradientBrush>
                        <GradientStop Color="#f4257b" Offset="0"/>
                        <GradientStop Color="Transparent" Offset="1"/>
                    </RadialGradientBrush>
                </Ellipse.Fill>
                <Ellipse.Effect>
                    <BlurEffect Radius="120"/>
                </Ellipse.Effect>
            </Ellipse>
            
            <!-- Bottom Right Glow -->
            <Ellipse Width="1200" Height="1200"
                     Canvas.Right="-400" Canvas.Bottom="-400"
                     Opacity="0.1">
                <Ellipse.Fill>
                    <RadialGradientBrush>
                        <GradientStop Color="#a855f7" Offset="0"/>
                        <GradientStop Color="Transparent" Offset="1"/>
                    </RadialGradientBrush>
                </Ellipse.Fill>
                <Ellipse.Effect>
                    <BlurEffect Radius="150"/>
                </Ellipse.Effect>
            </Ellipse>
        </Canvas>
        
        <Grid Margin="40,20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <Grid Grid.Row="0" Margin="20,20,20,30">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Back Button -->
                <Button Grid.Column="0"
                        Width="40" Height="40"
                        Cursor="Hand"
                        Click="BackButton_Click"
                        Background="Transparent"
                        BorderThickness="0">
                    <Button.Template>
                        <ControlTemplate TargetType="Button">
                            <Border Background="#1AFFFFFF"
                                    CornerRadius="20"
                                    BorderBrush="#33FFFFFF"
                                    BorderThickness="1"
                                    Width="40" Height="40">
                                <fa:PackIconFontAwesome Kind="ArrowLeftSolid"
                                                       Width="18" Height="18"
                                                       Foreground="White"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="RenderTransform">
                                        <Setter.Value>
                                            <ScaleTransform ScaleX="1.1" ScaleY="1.1"/>
                                        </Setter.Value>
                                    </Setter>
                                    <Setter Property="RenderTransformOrigin" Value="0.5,0.5"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Button.Template>
                </Button>

                <!-- Title -->
                <StackPanel Grid.Column="1" 
                           Orientation="Horizontal" 
                           HorizontalAlignment="Center">
                    <TextBlock Text="Select Your Frame"
                              FontSize="48"
                              FontWeight="Bold"
                              Foreground="White"
                              VerticalAlignment="Center"/>
                    <fa:PackIconFontAwesome Kind="ImageSolid"
                                           Width="36" Height="36"
                                           Foreground="#f4257b"
                                           VerticalAlignment="Center"
                                           Margin="12,0,0,0"/>
                </StackPanel>
            </Grid>

            <!-- Main Content: Left (Frame List) + Right (Preview) -->
            <Grid Grid.Row="1" Name="ContentGrid" Margin="20,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="350"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- LEFT SIDE: Frame Selection List -->
                <Border Grid.Column="0"
                       Background="#1AFFFFFF"
                       BorderBrush="#33FFFFFF"
                       BorderThickness="1"
                       CornerRadius="20"
                       Margin="0,0,15,0"
                       Padding="20">
                    <Border.Effect>
                        <DropShadowEffect Color="Black" BlurRadius="30" ShadowDepth="0" Opacity="0.4"/>
                    </Border.Effect>
                    
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Label -->
                        <TextBlock Grid.Row="0"
                                  Text="Available Frames"
                                  FontSize="20"
                                  FontWeight="Bold"
                                  Foreground="White"
                                  HorizontalAlignment="Center"
                                  Margin="0,0,0,20"/>

                        <!-- Frame List -->
                        <ScrollViewer Grid.Row="1" 
                                     VerticalScrollBarVisibility="Auto"
                                     HorizontalScrollBarVisibility="Disabled">
                            <ItemsControl Name="FrameListControl">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Name="FrameItemBorder"
                                               Background="#12000000"
                                               BorderBrush="#33FFFFFF"
                                               BorderThickness="1"
                                               CornerRadius="12"
                                               Margin="0,0,0,12"
                                               Padding="12"
                                               Cursor="Hand"
                                               MouseLeftButtonDown="FrameItem_Click">
                                            <Border.Style>
                                                <Style TargetType="Border">
                                                    <Style.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter Property="BorderBrush" Value="#f4257b"/>
                                                            <Setter Property="Background" Value="#20000000"/>
                                                        </Trigger>
                                                        <DataTrigger Binding="{Binding IsSelected}" Value="True">
                                                            <Setter Property="BorderBrush" Value="#f4257b"/>
                                                            <Setter Property="BorderThickness" Value="2"/>
                                                            <Setter Property="Background" Value="#25000000"/>
                                                            <Setter Property="Effect">
                                                                <Setter.Value>
                                                                    <DropShadowEffect Color="#f4257b" BlurRadius="15" ShadowDepth="0" Opacity="0.6"/>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Border.Style>
                                            
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="*"/>
                                                    <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>

                                                <!-- Frame Thumbnail -->
                                                <Border Grid.Row="0"
                                                       Background="#0a0506"
                                                       CornerRadius="8"
                                                       Padding="8"
                                                       Margin="0,0,0,10">
                                                    <Image Source="{Binding ThumbnailSource}"
                                                          Stretch="Uniform"
                                                          Height="180"
                                                          HorizontalAlignment="Center"
                                                          VerticalAlignment="Center"/>
                                                </Border>

                                                <!-- Frame Name -->
                                                <TextBlock Grid.Row="1"
                                                          Text="{Binding DisplayName}"
                                                          FontSize="16"
                                                          FontWeight="SemiBold"
                                                          Foreground="White"
                                                          HorizontalAlignment="Center"
                                                          TextAlignment="Center"/>

                                                <!-- Selected Indicator -->
                                                <Border Grid.Row="0"
                                                       Background="#f4257b"
                                                       CornerRadius="8"
                                                       Padding="8,4"
                                                       HorizontalAlignment="Right"
                                                       VerticalAlignment="Top"
                                                       Margin="8"
                                                       Visibility="{Binding IsSelected, Converter={StaticResource BoolToVisibilityConverter}}">
                                                    <StackPanel Orientation="Horizontal">
                                                        <fa:PackIconFontAwesome Kind="CheckSolid"
                                                                               Width="14" Height="14"
                                                                               Foreground="White"
                                                                               VerticalAlignment="Center"
                                                                               Margin="0,0,4,0"/>
                                                        <TextBlock Text="SELECTED"
                                                                  FontSize="11"
                                                                  FontWeight="Bold"
                                                                  Foreground="White"
                                                                  VerticalAlignment="Center"/>
                                                    </StackPanel>
                                                </Border>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                    </Grid>
                </Border>

                <!-- RIGHT SIDE: Frame Preview -->
                <Border Grid.Column="1"
                       Background="#1AFFFFFF"
                       BorderBrush="#33FFFFFF"
                       BorderThickness="1"
                       CornerRadius="20"
                       Margin="15,0,0,0"
                       Padding="25">
                    <Border.Effect>
                        <DropShadowEffect Color="Black" BlurRadius="30" ShadowDepth="0" Opacity="0.4"/>
                    </Border.Effect>
                    
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Preview Label -->
                        <StackPanel Grid.Row="0" Orientation="Vertical" Margin="0,0,0,20">
                            <TextBlock Text="Preview"
                                      FontSize="24"
                                      FontWeight="Bold"
                                      Foreground="White"
                                      HorizontalAlignment="Center"/>
                            <TextBlock Name="SelectedFrameNameText"
                                      Text="Select a frame to preview"
                                      FontSize="16"
                                      FontWeight="Normal"
                                      Foreground="#99FFFFFF"
                                      HorizontalAlignment="Center"
                                      Margin="0,8,0,0"/>
                        </StackPanel>

                        <!-- Preview Area -->
                        <Border Grid.Row="1"
                               Background="#0a0506"
                               BorderBrush="#33FFFFFF"
                               BorderThickness="1"
                               CornerRadius="16"
                               Padding="15">
                            <Viewbox Stretch="Uniform">
                                <Image Name="FramePreviewImage"
                                      Stretch="Uniform"
                                      HorizontalAlignment="Center"
                                      VerticalAlignment="Center"
                                      MinWidth="400"
                                      MinHeight="600"/>
                            </Viewbox>
                        </Border>
                    </Grid>
                </Border>
            </Grid>

            <!-- Navigation Buttons -->
            <Grid Grid.Row="2" Name="NavigationGrid" Margin="0,30,0,30">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Back Button -->
                <Button Grid.Column="0"
                       MinWidth="180"
                       Height="70"
                       Margin="0,0,10,0"
                       HorizontalAlignment="Right"
                       Cursor="Hand"
                       Click="BackButton_Click">
                    <Button.Template>
                        <ControlTemplate TargetType="Button">
                            <Border Background="#2a2a2a"
                                    CornerRadius="35"
                                    BorderBrush="#33FFFFFF"
                                    BorderThickness="1">
                                <StackPanel Orientation="Horizontal"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center">
                                    <fa:PackIconFontAwesome Kind="ArrowLeftSolid"
                                                           Width="18" Height="18"
                                                           Foreground="White"
                                                           VerticalAlignment="Center"
                                                           Margin="0,0,8,0"/>
                                    <TextBlock Text="BACK"
                                              FontSize="14"
                                              FontWeight="Bold"
                                              Foreground="White"
                                              VerticalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="RenderTransform">
                                        <Setter.Value>
                                            <ScaleTransform ScaleX="1.05" ScaleY="1.05"/>
                                        </Setter.Value>
                                    </Setter>
                                    <Setter Property="RenderTransformOrigin" Value="0.5,0.5"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Button.Template>
                </Button>

                <!-- Continue/Print Button -->
                <Button Grid.Column="1"
                       Name="ContinueButton"
                       MinWidth="250"
                       Height="80"
                       Margin="10,0,0,0"
                       HorizontalAlignment="Left"
                       Cursor="Hand"
                       IsEnabled="False"
                       Click="ContinueButton_Click">
                    <Button.Template>
                        <ControlTemplate TargetType="Button">
                            <Border Background="#f4257b"
                                    CornerRadius="40">
                                <Border.Effect>
                                    <DropShadowEffect Color="#f4257b" BlurRadius="30" ShadowDepth="0" Opacity="0.6"/>
                                </Border.Effect>
                                <StackPanel Orientation="Horizontal"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center">
                                    <TextBlock Text="CONTINUE"
                                              FontSize="18"
                                              FontWeight="Bold"
                                              Foreground="White"
                                              VerticalAlignment="Center"/>
                                    <fa:PackIconFontAwesome Kind="ArrowRightSolid"
                                                           Width="18" Height="18"
                                                           Foreground="White"
                                                           VerticalAlignment="Center"
                                                           Margin="8,0,0,0"/>
                                </StackPanel>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter Property="Opacity" Value="0.5"/>
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="RenderTransform">
                                        <Setter.Value>
                                            <ScaleTransform ScaleX="1.05" ScaleY="1.05"/>
                                        </Setter.Value>
                                    </Setter>
                                    <Setter Property="RenderTransformOrigin" Value="0.5,0.5"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Button.Template>
                </Button>
            </Grid>

            <!-- Loading Overlay -->
            <Border Name="LoadingPanel"
                    Grid.RowSpan="3"
                    Background="#E0000000"
                    Visibility="Collapsed">
                <Border Width="500"
                        Height="300"
                        Background="#1AFFFFFF"
                        CornerRadius="30"
                        BorderBrush="#33FFFFFF"
                        BorderThickness="2"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Padding="40,35">
                    <Border.Effect>
                        <DropShadowEffect Color="#f4257b" BlurRadius="60" ShadowDepth="0" Opacity="0.7"/>
                    </Border.Effect>
                    
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <TextBlock Grid.Row="0"
                                  Name="LoadingText"
                                  Text="Loading Frames..."
                                  FontSize="32"
                                  FontWeight="Bold"
                                  Foreground="White"
                                  HorizontalAlignment="Center"
                                  Margin="0,0,0,35">
                            <TextBlock.Effect>
                                <DropShadowEffect Color="#f4257b" BlurRadius="25" ShadowDepth="0" Opacity="0.9"/>
                            </TextBlock.Effect>
                        </TextBlock>
                        
                        <Grid Grid.Row="1" Width="400" Height="30">
                            <Border Background="#30FFFFFF" CornerRadius="4" Height="8" VerticalAlignment="Center"/>
                            <Rectangle x:Name="LoadingBox"
                                      Width="60" Height="20"
                                      RadiusX="4" RadiusY="4"
                                      HorizontalAlignment="Left"
                                      VerticalAlignment="Center">
                                <Rectangle.Fill>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                        <GradientStop Color="#f4257b" Offset="0"/>
                                        <GradientStop Color="#a855f7" Offset="1"/>
                                    </LinearGradientBrush>
                                </Rectangle.Fill>
                                <Rectangle.Effect>
                                    <DropShadowEffect Color="#f4257b" BlurRadius="20" ShadowDepth="0" Opacity="0.9"/>
                                </Rectangle.Effect>
                                <Rectangle.RenderTransform>
                                    <TranslateTransform x:Name="LoadingTransform"/>
                                </Rectangle.RenderTransform>
                                <Rectangle.Triggers>
                                    <EventTrigger RoutedEvent="Loaded">
                                        <BeginStoryboard>
                                            <Storyboard RepeatBehavior="Forever">
                                                <DoubleAnimation Storyboard.TargetName="LoadingTransform"
                                                               Storyboard.TargetProperty="X"
                                                               From="0" To="340" Duration="0:0:1.2"
                                                               AutoReverse="True">
                                                    <DoubleAnimation.EasingFunction>
                                                        <CubicEase EasingMode="EaseInOut"/>
                                                    </DoubleAnimation.EasingFunction>
                                                </DoubleAnimation>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                </Rectangle.Triggers>
                            </Rectangle>
                        </Grid>
                    </Grid>
                </Border>
            </Border>
        </Grid>
    </Grid>
</Page>
